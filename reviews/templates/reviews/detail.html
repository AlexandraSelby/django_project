{% extends "reviews/base.html" %}
{% load static %}

{% block title %}{{ review.brand }} — {{ review.fragrance_name }}{% endblock %}

{% block content %}
    
    <p class="back-link"><a href="{% url 'reviews:home' %}">← Back to reviews</a></p>

    <div class="review-card detail-card">
        
        <header class="detail-header">
            <h2 class="fragrance-title">
                {{ review.brand }} &mdash; {{ review.fragrance_name }}
            </h2>
            
            <div class="rating detail-rating">
                <strong>Rating:</strong> 
                {% for i in "12345"|make_list %}
                    {% if forloop.counter <= review.rating %}
                        <span class="star">★</span>
                    {% else %}
                        <span class="star-empty">☆</span>
                    {% endif %}
                {% endfor %}
                ({{ review.rating }}/5)
            </div>
        </header>
        
        <p class="review-body detail-text">
            {{ review.body|linebreaksbr }}
        </p>

        {% with review.youtube_embed_src_auto as yt %}
            {% if yt %}
                <div class="video-responsive detail-video">
                </div>
            {% endif %}
        {% endwith %}

        <p class="review-meta"><small>Added: {{ review.created }}</small></p>
    </div>

    {% if user.is_authenticated and review.author_id == user.id %}
        <div class="control-buttons">
            <a href="{% url 'reviews:edit' review.id %}"
                class="btn btn-primary">
                Edit
            </a>

            <form method="post"
                    action="{% url 'reviews:delete' review.id %}"
                    onsubmit="return confirm('Delete this review? This cannot be undone.');">
                {% csrf_token %}
                <button type="submit" class="btn btn-delete">Delete</button>
            </form>
        </div>
    {% endif %}
{% endblock %}